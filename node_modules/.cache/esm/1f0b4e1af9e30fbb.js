'use strict';let createConnection;_f9e‍.w("./src/db/connection",[["default",["createConnection"],function(v){createConnection=v}]]);

const Hapi = require('@hapi/hapi');


const init = async () => {

    //create server
    const server = Hapi.server({
        port : 3000,
        host : 'localhost'
    });


    server.route({
        method: 'GET',
        path: '/',
        handler: (request,h) => {
            return h.response({statusCode: 200,
                hello: 'Hello mamank!'}).code(200);
        }
    })



    //start the server
    createConnection()
    .then(async (connection) => {
        if(connection.isConnected){
            console.log('DATABASE CONNECTED');

            await server.start();
            console.log(`Server connected on port ${server.info.uri}`)

            process.on('unhandledRejection', (err)=>{
                _f9e‍.g.console.log(err);
                process.exit(1);
            })
        } else {
            throw new Error(`Database Connection Failed`);
        }
    })

    .catch((err)=> {
        console.log('Error starting application');
        _f9e‍.g.console.error(err);
    })

}


init();